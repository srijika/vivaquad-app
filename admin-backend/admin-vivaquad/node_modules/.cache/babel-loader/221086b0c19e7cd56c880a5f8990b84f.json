{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/html/project/vivaquad/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/var/www/html/project/vivaquad/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/var/www/html/project/vivaquad/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,Fragment,useEffect,useRef}from'react';import{Button,Row,Col,Upload,Modal}from'antd';import{connect}from'dva';import styles from'./index.less';var UploadImages=function UploadImages(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),disableBtn=_useState2[0],setDisableBtn=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),count=_useState4[0],setCount=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),fileList=_useState6[0],setFileList=_useState6[1];var inputRef=useRef();var dispatch=props.dispatch;useEffect(function(){var unmounted=false;return function(){unmounted=true;};},[props]);var onChange=function onChange(_ref){var newFileList=_ref.fileList;setFileList(newFileList);};var onPreview=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(file){var src,image,imgWindow;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:src=file.url;if(src){_context.next=5;break;}_context.next=4;return new Promise(function(resolve){var reader=new FileReader();reader.readAsDataURL(file.originFileObj);reader.onload=function(){return resolve(reader.result);};});case 4:src=_context.sent;case 5:image=new Image();image.src=src;imgWindow=window.open(src);imgWindow.document.write(image.outerHTML);case 9:case\"end\":return _context.stop();}}},_callee);}));return function onPreview(_x){return _ref2.apply(this,arguments);};}();var onFinish=function onFinish(){var rData=[];fileList.map(function(item){return rData.push({file:item.originFileObj,urls:item.thumbUrl});});setDisableBtn(true);setCount(rData.count);if(props.Extra){rData['Extra']=props.Extra;};props.returnImg(rData);props.closeFun();setFileList([]);setCount(0);setDisableBtn(false);};var cancelFun=function cancelFun(){setDisableBtn(false);props.closeFun();};var dummyUploadRequest=function dummyUploadRequest(_ref3){var file=_ref3.file,onSuccess=_ref3.onSuccess;setTimeout(function(){onSuccess(\"ok\");},0);};useEffect(function(){var unmounted=false;if(props.resetVal.length===0){setFileList([]);}return function(){unmounted=true;};},[props.resetVal]);return/*#__PURE__*/React.createElement(Modal,{key:1111,visible:props.visible,title:\"Upload Image's\",okText:\"Upload\",onCancel:cancelFun,onOk:onFinish,okButtonProps:{disabled:disableBtn}},/*#__PURE__*/React.createElement(Upload,{customRequest:dummyUploadRequest,listType:\"picture-card\",fileList:fileList,showUploadList:{showPreviewIcon:false},onChange:onChange,onPreview:onPreview,accept:\"image/png, image/gif, image/jpeg ,image/jpg , image/webp , image/apng\"},fileList.length<1&&'+ Upload'));};//export default CropImage;\nexport default connect(function(_ref4){var global=_ref4.global;return{global:global};})(UploadImages);","map":{"version":3,"sources":["/var/www/html/project/vivaquad/admin-vivaquad/src/components/upload-images/index.jsx"],"names":["React","useState","useCallback","Fragment","useEffect","useRef","Button","Row","Col","Upload","Modal","connect","styles","UploadImages","props","disableBtn","setDisableBtn","count","setCount","fileList","setFileList","inputRef","dispatch","unmounted","onChange","newFileList","onPreview","file","src","url","Promise","resolve","reader","FileReader","readAsDataURL","originFileObj","onload","result","image","Image","imgWindow","window","open","document","write","outerHTML","onFinish","rData","map","item","push","urls","thumbUrl","Extra","returnImg","closeFun","cancelFun","dummyUploadRequest","onSuccess","setTimeout","resetVal","length","visible","disabled","showPreviewIcon","global"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, Fragment, useEffect, useRef } from 'react';\r\nimport { Button, Row, Col, Upload, Modal } from 'antd';\r\nimport { connect } from 'dva';\r\n\r\nimport styles from './index.less';\r\n\r\nconst UploadImages = props =>{\r\n\tconst [disableBtn, setDisableBtn] = useState(false);\r\n\tconst [count, setCount] = useState(0)\r\n\tconst [fileList, setFileList] = useState([])\r\n\tconst inputRef = useRef();\r\n\tconst {dispatch} = props;\r\n\t\r\n\tuseEffect(() => {\r\n\t\tlet unmounted = false;\r\n\t\treturn () => {unmounted = true; }\r\n    },[props])\r\n\t\r\n\tconst onChange = ({ fileList: newFileList }) => {\r\n\t\tsetFileList(newFileList);\r\n\t  };\r\n\r\n\tconst onPreview = async file => {\r\n\t\tlet src = file.url;\r\n\t\tif (!src) {\r\n\t\t  src = await new Promise(resolve => {\r\n\t\t\tconst reader = new FileReader();\r\n\t\t\treader.readAsDataURL(file.originFileObj);\r\n\t\t\treader.onload = () => resolve(reader.result);\r\n\t\t  });\r\n\t\t}\r\n\t\tconst image = new Image();\r\n\t\timage.src = src;\r\n\t\tconst imgWindow = window.open(src);\r\n\t\timgWindow.document.write(image.outerHTML);\r\n\t};\r\n\t\r\n\tconst onFinish=()=>{\r\n\t\t\r\n\t\tlet rData = [];\r\n\t\tfileList.map(item=> rData.push({file : item.originFileObj, urls:item.thumbUrl}))\r\n\t\tsetDisableBtn(true)\r\n\t\tsetCount(rData.count);\r\n\r\n\t\tif(props.Extra){rData['Extra'] = props.Extra};\r\n\t\tprops.returnImg(rData)\r\n\t\tprops.closeFun();\r\n\t\tsetFileList([])\r\n\t\tsetCount(0);\r\n\t\tsetDisableBtn(false)\r\n\t\t\r\n\t}\r\n\t\r\n\tconst cancelFun=()=>{\r\n\t\tsetDisableBtn(false)\t\r\n\t\tprops.closeFun();\r\n\t}\r\n\t\r\n\tconst dummyUploadRequest = ({ file, onSuccess }) => {\r\n\t\tsetTimeout(() => {\r\n\t\t  onSuccess(\"ok\");\r\n\t\t}, 0);\r\n\t  };\r\n\r\n\tuseEffect(() => {\r\n\t\tlet unmounted = false;\r\n\t\tif(props.resetVal.length===0){\r\n\t\t\tsetFileList([])\r\n\t\t}\r\n\t\treturn () => {\r\n  \t  unmounted = true;\r\n      }\r\n\t}, [props.resetVal]); \r\n\t\r\n\treturn <Modal key={1111} visible={props.visible} title=\"Upload Image's\" okText=\"Upload\" onCancel={cancelFun} onOk={onFinish} okButtonProps={{ disabled: disableBtn }}>\r\n\t\t\t<Upload \r\n\t\t\t\tcustomRequest={dummyUploadRequest}\r\n\t\t\t\tlistType=\"picture-card\"\r\n\t\t\t\tfileList={fileList}\r\n\t\t\t\tshowUploadList={{showPreviewIcon:false}}\r\n\t\t\t\tonChange={onChange}\r\n\t\t\t\tonPreview={onPreview}\r\n\t\t\t\taccept=\"image/png, image/gif, image/jpeg ,image/jpg , image/webp , image/apng\"\r\n\r\n\t\t\t>\r\n\t\t\t{fileList.length < ( 1) && '+ Upload'}\r\n\t\t  </Upload>\r\n        </Modal>\r\n\t\t\r\n}\r\n\r\n//export default CropImage;\r\nexport default connect(({global }) => ({\r\n  global: global,\r\n}))(UploadImages);"]},"metadata":{},"sourceType":"module"}