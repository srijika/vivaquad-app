{"ast":null,"code":"import _regeneratorRuntime from\"/var/www/html/project/vivaquad/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/var/www/html/project/vivaquad/admin-vivaquad/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{login as _login,Register,forgetpassword,resetPassword as _resetPassword,resendOTPTOUser,varifyUser}from'../services/api';import{message}from'antd';export default{namespace:'auth',state:{//data: null,\nlogin:{count:0},forgot:{count:0},reg:{count:0},alrdreg:{count:0},varify:{}},subscriptions:{setup:function setup(_ref){var dispatch=_ref.dispatch,history=_ref.history;}},effects:{varifyOtp:/*#__PURE__*/_regeneratorRuntime.mark(function varifyOtp(_ref2,_ref3){var payload,call,put,response;return _regeneratorRuntime.wrap(function varifyOtp$(_context){while(1){switch(_context.prev=_context.next){case 0:payload=_ref2.payload;call=_ref3.call,put=_ref3.put;_context.next=4;return call(varifyUser,payload);case 4:response=_context.sent;if(response.status){_context.next=9;break;}message.error(response.msg||response.message||response.err,5);_context.next=11;break;case 9:_context.next=11;return put(_objectSpread({type:'varifySuccess'},response));case 11:case\"end\":return _context.stop();}}},varifyOtp);}),resendOtp:/*#__PURE__*/_regeneratorRuntime.mark(function resendOtp(_ref4,_ref5){var payload,call,put,response;return _regeneratorRuntime.wrap(function resendOtp$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:payload=_ref4.payload;call=_ref5.call,put=_ref5.put;_context2.next=4;return call(resendOTPTOUser,payload);case 4:response=_context2.sent;if(!response.status){message.error(response.msg||response.message||response.err,5);}else{if(response.status){message.success(response.msg||response.message||response.err,5);}}case 6:case\"end\":return _context2.stop();}}},resendOtp);}),login:/*#__PURE__*/_regeneratorRuntime.mark(function login(_ref6,_ref7){var payload,call,put,response,hostname,activeRole,role,_role;return _regeneratorRuntime.wrap(function login$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:payload=_ref6.payload;call=_ref7.call,put=_ref7.put;_context3.next=4;return call(_login,payload);case 4:response=_context3.sent;if(response.status){_context3.next=15;break;}if(!(response.msg==\"Your account is not verified\"||response.message==\"Your account is not verified\")){_context3.next=14;break;}localStorage.setItem(\"flow\",'sin');localStorage.setItem('user_email',payload.username);localStorage.setItem(\"LoginCred\",JSON.stringify(payload));_context3.next=12;return put(_objectSpread({type:'varify'},response));case 12:_context3.next=15;break;case 14:message.error(response.msg||response.message||response.err,5);case 15:if(!response.status){_context3.next=50;break;}hostname=window.location.hostname;activeRole='ADMIN';if(!(window.location.hostname==='localhost')){_context3.next=35;break;}role=response.user.role;if(!(role!==\"REGULAR\"&&role!==\"GUEST\")){_context3.next=32;break;}localStorage.removeItem('flow');localStorage.removeItem('LoginCred');localStorage.setItem('token',response.accessToken);localStorage.setItem('role',role);localStorage.setItem('user',JSON.stringify(response.user));localStorage.setItem('userId',response.user._id);localStorage.setItem('isEmailVerified',response.user_detail.isEmailVerified?response.user_detail.isEmailVerified===true?'true':'false':'false');_context3.next=30;return put(_objectSpread({type:'save'},response));case 30:_context3.next=33;break;case 32:message.error(\"You are not authorized to Login...!\",5);case 33:_context3.next=50;break;case 35:_role=response.user.role;if(!(_role===activeRole)){_context3.next=49;break;}localStorage.removeItem('flow');localStorage.removeItem('LoginCred');localStorage.setItem('token',response.accessToken);localStorage.setItem('role',_role);localStorage.setItem('user',JSON.stringify(response.user));localStorage.setItem('userId',response.user._id);localStorage.setItem('isMobileVerified',response.user.isMobileVerified?response.user.isMobileVerified===true?'true':'false':'false');localStorage.setItem('isEmailVerified',response.user.isEmailVerified?response.user.isEmailVerified===true?'true':'false':'false');_context3.next=47;return put(_objectSpread({type:'save'},response));case 47:_context3.next=50;break;case 49:message.error(\"You are not authorized to Login...!\",5);case 50:case\"end\":return _context3.stop();}}},login);}),forgotFun:/*#__PURE__*/_regeneratorRuntime.mark(function forgotFun(_ref8,_ref9){var payload,call,put,response;return _regeneratorRuntime.wrap(function forgotFun$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:payload=_ref8.payload;call=_ref9.call,put=_ref9.put;_context4.next=4;return call(forgetpassword,payload);case 4:response=_context4.sent;if(!response.status){message.error(response.msg||response.message||response.err,5);}if(response.status){message.success(response.msg||response.message||response.err,5);}localStorage.setItem(\"flow\",'forgot');localStorage.setItem('user_email',payload.username);_context4.next=11;return put(_objectSpread({type:'forgot'},response));case 11:case\"end\":return _context4.stop();}}},forgotFun);}),resetPassword:/*#__PURE__*/_regeneratorRuntime.mark(function resetPassword(_ref10,_ref11){var payload,call,put,response;return _regeneratorRuntime.wrap(function resetPassword$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:payload=_ref10.payload;call=_ref11.call,put=_ref11.put;_context5.next=4;return call(_resetPassword,payload);case 4:response=_context5.sent;console.log(response);if(response.status){_context5.next=10;break;}message.error(response.msg||response.message||\"Something Went to wrong...Please Try Again!\",5);_context5.next=13;break;case 10:message.success(response.msg||response.message||\"Password Successfully Changed... Login again!\",5);_context5.next=13;return put(_objectSpread({type:'resetPasswordSuccess'},response));case 13:case\"end\":return _context5.stop();}}},resetPassword);}),register:/*#__PURE__*/_regeneratorRuntime.mark(function register(_ref12,_ref13){var payload,call,put,response;return _regeneratorRuntime.wrap(function register$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:payload=_ref12.payload;call=_ref13.call,put=_ref13.put;_context6.next=4;return call(Register,payload);case 4:response=_context6.sent;if(response.status){_context6.next=21;break;}if(!(response.msg==\"This Email is already registered\"||response.message==\"This Email is already registered\")){_context6.next=12;break;}message.success(\"Your email is already register in Choovoo Barber so login with your email & password..!\",5);_context6.next=10;return put(_objectSpread({type:'alrdreg'},response));case 10:_context6.next=19;break;case 12:if(!(response.msg==\"This Mobile No is already registered\"||response.message==\"This Mobile No is already registered\")){_context6.next=18;break;}message.success(\"Your mobile number is already register in Choovoo Barber so login with your mobile number & password..!\",5);_context6.next=16;return put(_objectSpread({type:'alrdreg'},response));case 16:_context6.next=19;break;case 18:message.error(response.msg||response.message||response.err,5);case 19:_context6.next=24;break;case 21:if(response.status){message.success(\"Register Successfully!\",5);}_context6.next=24;return put(_objectSpread({type:'reg'},response));case 24:case\"end\":return _context6.stop();}}},register);}),logoutApp:/*#__PURE__*/_regeneratorRuntime.mark(function logoutApp(_ref14,_ref15){var _,call,put;return _regeneratorRuntime.wrap(function logoutApp$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_=_ref14._;call=_ref15.call,put=_ref15.put;localStorage.removeItem('token');localStorage.removeItem('role');localStorage.removeItem('user');_context7.next=7;return put({type:'logout'});case 7:case\"end\":return _context7.stop();}}},logoutApp);})},reducers:{otpSendSuccess:function otpSendSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:_objectSpread({},action),login:{count:0}});},varifySuccess:function varifySuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:_objectSpread({},action),login:{count:0}});},save:function save(state,action){action.count=state.login.count+1;return _objectSpread(_objectSpread({},state),{},{login:action,varify:{}});},varify:function varify(state,action){return _objectSpread(_objectSpread({},state),{},{login:'varify',varify:{}});},forgot:function forgot(state,action){action.count=state.forgot.count+1;return _objectSpread(_objectSpread({},state),{},{forgot:action});},resetPasswordSuccess:function resetPasswordSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{resetPassword:_objectSpread({},action),forgot:{}});},resetPasswordSuccessDone:function resetPasswordSuccessDone(state,action){return _objectSpread(_objectSpread({},state),{},{resetPassword:{}});},registerSuccess:function registerSuccess(state,action){action.count=0;return _objectSpread(_objectSpread({},state),{},{reg:{count:0}});},alrdregisterSuccess:function alrdregisterSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:{},login:{count:0}});},verifyBackNuttunSuccess:function verifyBackNuttunSuccess(state,action){return _objectSpread(_objectSpread({},state),{},{varify:{},login:{count:0}});},verotpSuccess:function verotpSuccess(state,action){action.count=0;return _objectSpread(_objectSpread({},state),{},{alrdreg:{count:0}});},alrdreg:function alrdreg(state,action){action.count=state.alrdreg.count+1;return _objectSpread(_objectSpread({},state),{},{alrdreg:{action:action}});},reg:function reg(state,action){action.count=state.reg.count+1;return _objectSpread(_objectSpread({},state),{},{reg:{action:action}});},logout:function logout(state){return _objectSpread(_objectSpread({},state),{},{login:{count:0},reg:{count:0}});}}};","map":{"version":3,"sources":["/var/www/html/project/vivaquad/admin-vivaquad/src/models/auth.js"],"names":["login","Register","forgetpassword","resetPassword","resendOTPTOUser","varifyUser","message","namespace","state","count","forgot","reg","alrdreg","varify","subscriptions","setup","dispatch","history","effects","varifyOtp","payload","call","put","response","status","error","msg","err","type","resendOtp","success","localStorage","setItem","username","JSON","stringify","hostname","window","location","activeRole","role","user","removeItem","accessToken","_id","user_detail","isEmailVerified","isMobileVerified","forgotFun","console","log","register","logoutApp","_","reducers","otpSendSuccess","action","varifySuccess","save","resetPasswordSuccess","resetPasswordSuccessDone","registerSuccess","alrdregisterSuccess","verifyBackNuttunSuccess","verotpSuccess","logout"],"mappings":"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","sourcesContent":["import { login,  Register, forgetpassword, resetPassword, resendOTPTOUser, varifyUser } from '../services/api'\r\nimport { message } from 'antd';\r\nexport default {\r\n  namespace: 'auth',\r\n\r\n  state: {\r\n    //data: null,\r\n    login: { count: 0 },\r\n    forgot: { count: 0 },\r\n    reg: { count: 0 },\r\n    alrdreg: { count: 0 },\r\n    varify: {}\r\n  },\r\n\r\n  subscriptions: {\r\n    setup({ dispatch, history }) {\r\n    },\r\n  },\r\n\r\n  effects: {\r\n    *varifyOtp({ payload }, { call, put }) {\r\n      const response = yield call(varifyUser, payload);\r\n      if (!response.status) {\r\n        message.error(response.msg || response.message || response.err, 5);\r\n      } else {\r\n        yield put({ type: 'varifySuccess', ...response });\r\n      }\r\n    },\r\n    *resendOtp({ payload }, { call, put }) {\r\n      const response = yield call(resendOTPTOUser, payload);\r\n      if (!response.status) {\r\n        message.error(response.msg || response.message || response.err, 5);\r\n      } else {\r\n        if (response.status) { message.success(response.msg || response.message || response.err, 5); }\r\n      }\r\n    },\r\n    *login({ payload }, { call, put }) {\r\n      const response = yield call(login, payload);\r\n\r\n\r\n      if (!response.status) {\r\n        if (response.msg == \"Your account is not verified\" || response.message == \"Your account is not verified\") {\r\n          localStorage.setItem(\"flow\", 'sin');\r\n          localStorage.setItem('user_email', payload.username);\r\n          localStorage.setItem(\"LoginCred\", JSON.stringify(payload));\r\n          yield put({ type: 'varify', ...response });\r\n        } else {\r\n          message.error(response.msg || response.message || response.err, 5);\r\n        }\r\n      }\r\n      if (response.status) {\r\n        let hostname = window.location.hostname;\r\n\r\n        let activeRole = 'ADMIN';\r\n if(window.location.hostname === 'localhost') {\r\n            let role = response.user.role;\r\n            if (role !== \"REGULAR\" && role !== \"GUEST\") //For localhost \r\n            {\r\n              localStorage.removeItem('flow');\r\n              localStorage.removeItem('LoginCred')\r\n              localStorage.setItem('token', response.accessToken);\r\n              localStorage.setItem('role', role);\r\n              localStorage.setItem('user', JSON.stringify(response.user));\r\n              localStorage.setItem('userId', response.user._id);\r\n  \r\n              localStorage.setItem('isEmailVerified', response.user_detail.isEmailVerified ? response.user_detail.isEmailVerified === true ? 'true' : 'false' : 'false');\r\n              yield put({ type: 'save', ...response });\r\n            } else {\r\n              message.error(\"You are not authorized to Login...!\", 5);\r\n            }\r\n          }else {\r\n            let role = response.user.role;\r\n            if (role === activeRole) //For localhost \r\n            { \r\n              localStorage.removeItem('flow');\r\n              localStorage.removeItem('LoginCred')\r\n              localStorage.setItem('token', response.accessToken);\r\n              localStorage.setItem('role', role);\r\n              localStorage.setItem('user', JSON.stringify(response.user));\r\n              localStorage.setItem('userId', response.user._id);\r\n              localStorage.setItem('isMobileVerified', response.user.isMobileVerified ? response.user.isMobileVerified === true ? 'true' : 'false' : 'false');\r\n              localStorage.setItem('isEmailVerified', response.user.isEmailVerified ? response.user.isEmailVerified === true ? 'true' : 'false' : 'false');\r\n              yield put({ type: 'save', ...response });\r\n            } else {\r\n              message.error(\"You are not authorized to Login...!\", 5);\r\n            }\r\n          }\r\n        }\r\n    },\r\n    *forgotFun({ payload }, { call, put }) {\r\n      const response = yield call(forgetpassword, payload);\r\n      if (!response.status) { message.error(response.msg || response.message || response.err, 5); }\r\n      if (response.status) { message.success(response.msg || response.message || response.err, 5); }\r\n      localStorage.setItem(\"flow\", 'forgot');\r\n      localStorage.setItem('user_email', payload.username);\r\n      yield put({ type: 'forgot', ...response });\r\n    },\r\n    *resetPassword({ payload }, { call, put }) {\r\n      const response = yield call(resetPassword, payload);\r\n      console.log(response)\r\n      if (!response.status) {\r\n        message.error(response.msg || response.message || \"Something Went to wrong...Please Try Again!\", 5);\r\n      } else {\r\n        message.success(response.msg || response.message || \"Password Successfully Changed... Login again!\", 5);\r\n        yield put({ type: 'resetPasswordSuccess', ...response });\r\n      }\r\n\r\n    },\r\n    *register({ payload }, { call, put }) {\r\n      const response = yield call(Register, payload);\r\n      if (!response.status) {\r\n        if (response.msg == \"This Email is already registered\" || response.message == \"This Email is already registered\") {\r\n          message.success(\"Your email is already register in Choovoo Barber so login with your email & password..!\", 5);\r\n          yield put({ type: 'alrdreg', ...response });\r\n        } else if (response.msg == \"This Mobile No is already registered\" || response.message == \"This Mobile No is already registered\") {\r\n          message.success(\"Your mobile number is already register in Choovoo Barber so login with your mobile number & password..!\", 5);\r\n          yield put({ type: 'alrdreg', ...response });\r\n        } else {\r\n          message.error(response.msg || response.message || response.err, 5);\r\n        }\r\n      } else {\r\n        if (response.status) { message.success(\"Register Successfully!\", 5); }\r\n        yield put({ type: 'reg', ...response });\r\n      }\r\n\r\n    },\r\n    *logoutApp({ _ }, { call, put }) {\r\n      localStorage.removeItem('token')\r\n      localStorage.removeItem('role')\r\n      localStorage.removeItem('user')\r\n      yield put({ type: 'logout' });\r\n    },\r\n  },\r\n\r\n  reducers: {\r\n    otpSendSuccess(state, action) {\r\n      return {\r\n        ...state,\r\n        varify: { ...action }, login: { count: 0 }\r\n      };\r\n    },\r\n    varifySuccess(state, action) {\r\n      return {\r\n        ...state,\r\n        varify: { ...action }, login: { count: 0 }\r\n      };\r\n    },\r\n    save(state, action) {\r\n      action.count = state.login.count + 1;\r\n      return {\r\n        ...state,\r\n        login: action, varify: {}\r\n      };\r\n    },\r\n    varify(state, action) {\r\n      return {\r\n        ...state,\r\n        login: 'varify', varify: {}\r\n      };\r\n    },\r\n    forgot(state, action) {\r\n      action.count = state.forgot.count + 1;\r\n      return { ...state, forgot: action };\r\n    },\r\n    resetPasswordSuccess(state, action) {\r\n      return {\r\n        ...state,\r\n        resetPassword: { ...action }, forgot: {}\r\n      };\r\n    },\r\n    resetPasswordSuccessDone(state, action) {\r\n      return { ...state, resetPassword: {} };\r\n    },\r\n    registerSuccess(state, action) {\r\n      action.count = 0;\r\n      return { ...state, reg: { count: 0 } };\r\n    },\r\n    alrdregisterSuccess(state, action) {\r\n      return { ...state, varify: {}, login: { count: 0 } };\r\n    },\r\n    verifyBackNuttunSuccess(state, action) {\r\n      return { ...state, varify: {}, login: { count: 0 } };\r\n    },\r\n    verotpSuccess(state, action) {\r\n      action.count = 0;\r\n      return { ...state, alrdreg: { count: 0 } };\r\n    },\r\n    alrdreg(state, action) {\r\n      action.count = state.alrdreg.count + 1;\r\n      return {\r\n        ...state,\r\n        alrdreg: { action }\r\n      };\r\n    },\r\n    reg(state, action) {\r\n      action.count = state.reg.count + 1;\r\n      return {\r\n        ...state,\r\n        reg: { action }\r\n      };\r\n    },\r\n    logout(state) {\r\n      return { ...state, login: { count: 0 }, reg: { count: 0 } };\r\n    },\r\n  },\r\n};"]},"metadata":{},"sourceType":"module"}